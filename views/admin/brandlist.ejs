<%- include ('./partials/header') -%>
    <section class="content-main">
        <div class="content-header">
            <div>
                <h2 class="content-title card-title">Brands </h2>
                <p>Add, edit or delete a Brand</p>
            </div>
            <div class="">
                <input type="text" placeholder="Search Categories" class=" form-control bg-white">
            </div>
            <div>
                <a href="/admin/btnbrand" class="btn btn-primary btn-sm rounded">Create new</a>
            </div>
        </div>
        <div class="card">
            <div class="card-body">
                <div class="row">
                    <div class="col-md-12">
                        <div class="table-responsive">
                            <table class="table table-hover">
                                <thead>
                                    <tr>
                                        <!-- <th class="text-center">
                                            <div class="form-check">
                                                <input class="form-check-input" type="checkbox" value="" />
                                            </div>
                                        </th> -->
                                        <th>Sl No.</th>
                                        <th>Name</th>
                                        <th>Description</th>
                                        <td>
                                        <th class="text-end">Action</th>
                                        </td>
                                    </tr>
                                </thead>
                                <tbody>
                                    <tr>
                                        <!-- <td class="text-center">
                                        <div class="form-check">
                                            <input class="form-check-input" type="checkbox" value="" />
                                        </div>
                                    </td> -->

                                        <% count=1 %>
                                            <% brand.forEach(function(brand) { %>
                                                <td>
                                                    <%=count%>
                                                </td>
                                                <td><b>
                                                        <%= brand.brandName%>
                                                    </b></td>
                                                <td>
                                                    <%= brand.brandDescription%>
                                                </td>
                                                <td>
                                                <td class="text-end">
                                                    <% if (brand.list) { %>
                                                        <button type="button" class="btn btn-md font-sm btn-primary rounded me-2 statusButton"
                                                            data-cat_id="<%=brand._id%>">UnList</button>
                                                        <% } else { %>
                                                            <button type="button" class="btn btn-sd font-sm btn-light me-2 statusButton"
                                                                data-cat_id="<%=brand._id%>">List</button>
                                                            <% } %>
                                                                <a href="/admin/deletebrand?id=<%=brand._id %>"
                                                                    class="btn btn-md font-sm btn-primary rounded">
                                                                    <i class="material-icons md-delete_forever"></i>
                                                                    Delete
                                                                    </div>
                                                                    </div> <!-- dropdown //end -->
                                                </td>
                                                </tr>
                                                <% count++ %>
                                                    <% }); %>
                            </td>
                            </tr>
                            </tbody>
                            </table>
                </div>
            </div> <!-- .col// -->
        </div> <!-- .row // -->
        </div> <!-- card body .// -->
        </div> <!-- card .// -->
    </section> <!-- content-main end// -->



    <%- include ('./partials/footer') -%>

        <script>
            $('.statusButton').on('click', function () {
                console.log('Button Clicked');
                let text = $(this).text().trim();
                console.log(text);
                let id = $(this).data('cat_id');
                data = { text: text };
                Swal.fire({
                    title: "Are you sure?",
                    text: "This action can't be undone.",
                    icon: 'warning',
                    showCancelButton: true,
                    confirmButtonColor: '#3085d6',
                    cancelButtonColor: '#d33',
                    confirmButtonText: 'Yes'
                }).then((result) => {
                    if (result.isConfirmed) {
                        $.ajax({
                            url: '/admin/categoryListUnlist?id=' + id,
                            method: 'post',
                            data: data,
                            success: function (response) {
                                if (response.message == '1') {
                                    Swal.fire({
                                        title: 'Success',
                                        text: 'Status updated successfully',
                                        icon: 'success',
                                        confirmButtonText: 'OK'
                                    }).then((result) => {
                                        if (result.isConfirmed) {
                                            location.reload();
                                        }
                                    });
                                } else {
                                    Swal.fire({
                                        title: 'Error',
                                        text: 'Something went wrong',
                                        icon: 'error',
                                        confirmButtonColor: '#3085d6',
                                        cancelButtonColor: '#d33',
                                        confirmButtonText: 'OK'
                                    });
                                }
                            },
                            error: function () {
                                Swal.fire({
                                    title: 'Error',
                                    text: 'Something went wrong',
                                    icon: 'error',
                                    confirmButtonColor: '#3085d6',
                                    cancelButtonColor: '#d33',
                                    confirmButtonText: 'OK'
                                });
                            }
                        });
                    }
                });
            });
        </script>